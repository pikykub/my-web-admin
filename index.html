<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZXNT STUDIO - Premium Web Rental</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --main-red: #ff0040; --dark-bg: #0a0a0a; --card-bg: #151515; }
        body { font-family: 'Kanit', sans-serif; margin: 0; background: var(--dark-bg); color: white; overflow-x: hidden; }

        /* üåÄ 1. Loading Screen */
        #loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--dark-bg); z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: opacity 0.5s ease; }
        .pulse-logo { width: 80px; height: 80px; background: var(--main-red); border-radius: 50%; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(255, 0, 64, 0.7); } 70% { transform: scale(1); box-shadow: 0 0 0 20px rgba(255, 0, 64, 0); } 100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(255, 0, 64, 0); } }

        /* Navbar */
        .navbar { background: rgba(0,0,0,0.85); backdrop-filter: blur(10px); padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid #222; }
        .logo { font-size: 24px; font-weight: bold; color: var(--main-red); }
        .admin-btn { border: 1px solid var(--main-red); padding: 5px 15px; border-radius: 20px; color: var(--main-red); cursor: pointer; display: none; font-size: 14px; }

        .container { max-width: 1100px; margin: 50px auto; padding: 0 20px; }

        /* üì¶ 2. Store Card */
        .card { background: var(--card-bg); border-radius: 20px; border: 1px solid #222; overflow: hidden; transition: 0.4s; }
        .card:hover { border-color: var(--main-red); transform: translateY(-10px); }
        .card-img { height: 250px; background: #000; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .card-img img { width: 100%; height: 100%; object-fit: cover; }
        .card-info { padding: 25px; text-align: center; }
        .price { font-size: 36px; font-weight: bold; color: var(--main-red); margin: 10px 0; }
        .btn-rent { background: var(--main-red); color: white; border: none; padding: 15px 40px; border-radius: 12px; font-weight: bold; cursor: pointer; width: 100%; font-size: 16px; }

        /* üîê 3. Admin Dashboard */
        #adminArea { display: none; background: #111; padding: 30px; border-radius: 25px; border: 1px dashed var(--main-red); margin-top: 50px; box-shadow: 0 0 20px rgba(255,0,64,0.1); }
        .form-group { margin-bottom: 15px; }
        label { display: block; color: #888; margin-bottom: 5px; font-size: 13px; }
        input { width: 100%; padding: 12px; background: #1a1a1a; border: 1px solid #333; color: white; border-radius: 10px; box-sizing: border-box; font-family: 'Kanit'; }
        .btn-save { background: #2ecc71; color: white; border: none; padding: 15px; border-radius: 12px; width: 100%; font-weight: bold; cursor: pointer; margin-top: 10px; }

        /* üí∞ 4. Payment UI */
        #payModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10000; justify-content: center; align-items: center; }
        .modal-body { background: white; color: #333; padding: 30px; border-radius: 25px; width: 90%; max-width: 380px; text-align: center; }
        .qr-box { width: 220px; height: 220px; background: #f0f0f0; margin: 20px auto; border-radius: 15px; overflow: hidden; }
        .qr-box img { width: 100%; height: 100%; }
        .bank-details { background: #f9f9f9; padding: 15px; border-radius: 15px; text-align: left; margin: 15px 0; border: 1px solid #eee; }
    </style>
</head>
<body onload="closeLoader()">

    <div id="loader">
        <div class="pulse-logo"></div>
        <p style="margin-top: 20px; letter-spacing: 3px; font-weight: 300;">ZXNT STUDIO LOADING...</p>
    </div>

    <nav class="navbar">
        <div class="logo">ZXNT STUDIO</div>
        <div id="navLinks">
            <span id="adminBtn" class="admin-btn" onclick="toggleAdmin()">ADMIN PANEL</span>
            <span id="userText" style="margin-left:15px; font-size:12px; color:#888;"></span>
        </div>
    </nav>

    <div class="container">
        <div class="card">
            <div class="card-img" id="pImgPreview"><img src="https://via.placeholder.com/600x400/111/ff0040?text=WEB+PREVIEW" alt="Web Preview"></div>
            <div class="card-info">
                <h2 id="pNameDisplay" style="margin:0;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</h2>
                <div class="price" id="pPriceDisplay">‡∏ø 0</div>
                <div style="display:flex; gap:10px;">
                    <a id="pDemoBtn" href="#" target="_blank" style="flex:1; background:#333; color:white; text-decoration:none; padding:15px; border-radius:12px; font-weight:bold; text-align:center;">‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</a>
                    <button class="btn-rent" onclick="openPay()" style="flex:1;">‡πÄ‡∏ä‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>
                </div>
            </div>
        </div>

        <div id="adminArea">
            <h2 style="color:var(--main-red); margin-top:0;">üõ† ‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</h2>
            <div style="background:#1a1a1a; padding:15px; border-radius:12px; margin-bottom:20px; border-left: 4px solid var(--main-red);">
                ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span id="statusLabel">...</span> | ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <span id="expireLabel">...</span>
            </div>
            
            <div class="form-group"><label>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label><input type="text" id="inName"></div>
            <div class="form-group"><label>‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label><input type="number" id="inPrice"></div>
            <div class="form-group"><label>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏Å‡πÄ‡∏ß‡πá‡∏ö</label><input type="text" id="inImg"></div>
            <div class="form-group"><label>‡∏•‡∏¥‡∏á‡∏Å‡πå Demo (‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)</label><input type="text" id="inDemo"></div>
            <div class="form-group"><label>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ QR Code (‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô)</label><input type="text" id="inQR"></div>
            <div class="form-group"><label>‡∏ï‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (YYYY-MM-DD)</label><input type="date" id="inExpire"></div>
            
            <button class="btn-save" onclick="updateSystem()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</button>
        </div>
    </div>

    <div id="payModal">
        <div class="modal-body">
            <h2 style="margin:0; color:var(--main-red);">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ä‡πà‡∏≤‡πÄ‡∏ß‡πá‡∏ö</h2>
            <div class="qr-box" id="qrContainer">‡∏£‡∏π‡∏õ QR Code</div>
            <div class="bank-details">
                <div style="margin-bottom:8px;"><strong>üì± TrueMoney:</strong> 080-920-0932</div>
                <div><strong>üè¶ KKP (‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ô‡∏≤‡∏Ñ‡∏¥‡∏ô):</strong> 208-351152-1</div>
            </div>
            <p style="font-size:11px; color:#999;">*‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏™‡∏•‡∏¥‡∏õ‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö</p>
            <button onclick="closePay()" style="width:100%; padding:12px; border:none; background:#eee; border-radius:10px; cursor:pointer; font-weight:bold;">‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
        import { getFirestore, doc, onSnapshot, updateDoc } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBORnXLQdZnETh9AMFMUx50FlLylKCVc2w",
            authDomain: "web-rental-system-d8894.firebaseapp.com",
            projectId: "web-rental-system-d8894",
            storageBucket: "web-rental-system-d8894.firebasestorage.app",
            messagingSenderId: "389385259939",
            appId: "1:389385259939:web:5a8de35f4a06b906e66816"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        const ADMIN_ID = "feirnbiddu10@gmail.com";

        window.closeLoader = () => {
            setTimeout(() => {
                const loader = document.getElementById('loader');
                loader.style.opacity = '0';
                setTimeout(() => loader.style.display = 'none', 500);
            }, 1200);
        };

        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('userText').innerText = user.email;
                if (user.email === ADMIN_ID) {
                    document.getElementById('adminBtn').style.display = 'inline-block';
                    syncData();
                }
            }
        });

        function syncData() {
            onSnapshot(doc(db, "shops", "shop001"), (snap) => {
                if (snap.exists()) {
                    const d = snap.data();
                    const now = new Date().toISOString().split('T')[0];

                    // --- ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Auto-Suspend) ---
                    if (d.expireDate && now > d.expireDate && d.status !== 'suspended') {
                        updateDoc(doc(db, "shops", "shop001"), { status: 'suspended' });
                    }

                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô
                    document.getElementById('pNameDisplay').innerText = d.name;
                    document.getElementById('pPriceDisplay').innerText = "‡∏ø " + d.price;
                    document.getElementById('pDemoBtn').href = d.demoUrl;
                    document.getElementById('pImgPreview').innerHTML = `<img src="${d.imgUrl}">`;
                    document.getElementById('qrContainer').innerHTML = `<img src="${d.qrUrl}">`;

                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô
                    document.getElementById('inName').value = d.name;
                    document.getElementById('inPrice').value = d.price;
                    document.getElementById('inImg').value = d.imgUrl;
                    document.getElementById('inDemo').value = d.demoUrl;
                    document.getElementById('inQR').value = d.qrUrl;
                    document.getElementById('inExpire').value = d.expireDate;
                    
                    document.getElementById('statusLabel').innerText = d.status === 'active' ? "üü¢ ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥" : "üî¥ ‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö";
                    document.getElementById('statusLabel').style.color = d.status === 'active' ? "#2ecc71" : "#e74c3c";
                    document.getElementById('expireLabel').innerText = d.expireDate || "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏∞‡∏ö‡∏∏";
                }
            });
        }

        window.updateSystem = async () => {
            await updateDoc(doc(db, "shops", "shop001"), {
                name: document.getElementById('inName').value,
                price: document.getElementById('inPrice').value,
                imgUrl: document.getElementById('inImg').value,
                demoUrl: document.getElementById('inDemo').value,
                qrUrl: document.getElementById('inQR').value,
                expireDate: document.getElementById('inExpire').value,
                status: 'active' // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡∏°‡πà
            });
            alert("‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
        };

        window.toggleAdmin = () => {
            const el = document.getElementById('adminArea');
            el.style.display = el.style.display === 'block' ? 'none' : 'block';
        };

        window.openPay = () => document.getElementById('payModal').style.display = 'flex';
        window.closePay = () => document.getElementById('payModal').style.display = 'none';
    </script>
</body>
</html>
